<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FastSwap.pro ‚Äî –û–±–º–µ–Ω 50+ –≤–∞–ª—é—Ç</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', system-ui, sans-serif; }
        body { background: #f8f9fa; color: #212529; padding: 16px; }
        .container { max-width: 700px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 24px; }
        header h1 { font-size: 24px; color: #0d6efd; margin-bottom: 8px; }
        header p { color: #6c757d; font-size: 15px; }

        .card { background: white; border-radius: 16px; padding: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.06); margin-bottom: 20px; }
        .input-group { margin-bottom: 18px; position: relative; }
        .input-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #495057; font-size: 15px; }

        /* –û–±—â–∏–π —Å—Ç–∏–ª—å –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª–µ–π */
        .input-field, .select-header {
            width: 100%; padding: 14px; border: 1px solid #ced4da; border-radius: 12px;
            font-size: 16px; background: white;
        }
        .input-field:focus, .select-header:focus {
            outline: none;
            border-color: #0d6efd;
            box-shadow: 0 0 0 2px rgba(13, 110, 253, 0.2);
        }

        /* –ö–∞—Å—Ç–æ–º–Ω—ã–π dropdown */
        .custom-select {
            position: relative;
            width: 100%;
        }
        .select-header {
            cursor: pointer; display: flex; justify-content: space-between; align-items: center;
        }
        .select-header::after {
            content: "‚ñº"; font-size: 12px; color: #6c757d; transform: scaleY(0.6);
        }
        .select-options {
            position: absolute; top: 100%; left: 0; right: 0;
            background: white; border: 1px solid #ced4da; border-top: none;
            border-radius: 0 0 12px 12px; max-height: 250px; overflow-y: auto;
            z-index: 10; display: none; box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .select-options.active { display: block; }
        .search-input {
            width: 100%; padding: 10px 14px; border: none; border-bottom: 1px solid #eee;
            font-size: 15px; outline: none;
        }
        .option { padding: 12px 14px; cursor: pointer; font-size: 15px; }
        .option:hover { background: #f1f5ff; }
        .option.selected { background: #e7f1ff; font-weight: 600; }

        /* –ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ–¥ –ø–æ–ª–µ–º —Å—É–º–º—ã */
        .hint {
            font-size: 13px; color: #6c757d; margin-top: 6px;
            position: absolute; left: 0; bottom: -22px;
        }

        .rate-info {
            background: #e7f1ff; border-radius: 12px; padding: 14px; text-align: center;
            margin: 20px 0; font-weight: 600; color: #0d6efd;
        }
        .result {
            text-align: center; margin: 20px 0; font-size: 18px; color: #212529;
        }
        button { 
            width: 100%; padding: 16px; background: #0d6efd; color: white; 
            border: none; border-radius: 12px; font-size: 17px; font-weight: 600; cursor: pointer;
        }
        button:hover { background: #0b5ed7; }
        button:disabled { background: #adb5bd; cursor: not-allowed; }
    </style>
</head>
<body>
    <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
<div id="sidebar" style="
    position: fixed; top: 0; left: -300px; width: 280px; height: 100vh;
    background: white; box-shadow: 4px 0 12px rgba(0,0,0,0.1);
    z-index: 1000; transition: left 0.3s ease;
    padding: 20px; display: flex; flex-direction: column;
">
    <button onclick="closeMenu()" style="
        align-self: flex-end; background: none; border: none; font-size: 24px;
        cursor: pointer; margin-bottom: 20px;
    ">√ó</button>
    
    <h2 style="font-size: 20px; margin-bottom: 24px; color: #0d6efd;">FastSwap.pro</h2>
    
    <nav style="display: flex; flex-direction: column; gap: 16px;">
        <a href="index.html" style="text-decoration: none; color: #212529; font-size: 17px; padding: 10px 0;">üè† –û–±–º–µ–Ω</a>
        <a href="support.html" style="text-decoration: none; color: #212529; font-size: 17px; padding: 10px 0;">‚ùì –ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>
        <a href="privacy.html" style="text-decoration: none; color: #212529; font-size: 17px; padding: 10px 0;">üîí –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
    </nav>
</div>

<!-- –û–≤–µ—Ä–ª–µ–π -->
<div id="overlay" style="
    position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
    background: rgba(0,0,0,0.4); z-index: 999; display: none;
"></div>

<!-- –ö–Ω–æ–ø–∫–∞ –º–µ–Ω—é –≤ —Ö–µ–¥–µ—Ä–µ -->
<header style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px;">
    <button id="menuBtn" style="
        background: none; border: none; font-size: 24px; cursor: pointer;
    ">‚ò∞</button>
    <div style="text-align: center; flex-grow: 1;">
        <h1>FastSwap.pro</h1>
        <p>–û–±–º–µ–Ω 50+ –≤–∞–ª—é—Ç: –∫—Ä–∏–ø—Ç–∞, —Ñ–∏–∞—Ç, –±–∞–Ω–∫–∏ –†–§</p>
    </div>
    <div style="width: 24px;"></div> <!-- –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ -->
</header>
    <div class="container">
        <header>
            <h1>FastSwap.pro</h1>
            <p>–û–±–º–µ–Ω 50+ –≤–∞–ª—é—Ç: –∫—Ä–∏–ø—Ç–∞, —Ñ–∏–∞—Ç, –±–∞–Ω–∫–∏ –†–§</p>
        </header>

        <div class="card">
            <div class="input-group">
                <label>–û—Ç–¥–∞–µ—Ç–µ</label>
                <div class="custom-select" id="fromSelect">
                    <div class="select-header" id="fromHeader">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞–ª—é—Ç—É</div>
                    <div class="select-options" id="fromOptions">
                        <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫...">
                        <div class="options-list" id="fromOptionsList"></div>
                    </div>
                </div>
            </div>

            <!-- –í—ã–±–æ—Ä –±–∞–Ω–∫–∞ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ RUB) -->
            <div class="input-group" id="bankSelect" style="display: none;">
                <label>–ë–∞–Ω–∫ / –ø–ª–∞—Ç—ë–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</label>
                <div class="custom-select" id="bankSelectCustom">
                    <div class="select-header" id="bankHeader">–í—ã–±–µ—Ä–∏—Ç–µ –±–∞–Ω–∫</div>
                    <div class="select-options" id="bankOptions">
                        <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫...">
                        <div class="options-list" id="bankOptionsList"></div>
                    </div>
                </div>
            </div>

            <div class="input-group">
                <label>–°—É–º–º–∞</label>
                <input type="number" id="amount" class="input-field" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" min="100" value="10000">
                <div class="hint" id="minHint">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: 100 RUB</div>
            </div>

            <div class="arrow" style="text-align: center; margin: 16px 0; font-size: 24px; color: #0d6efd;">‚Üì</div>

            <div class="input-group">
                <label>–ü–æ–ª—É—á–∞–µ—Ç–µ</label>
                <div class="custom-select" id="toSelect">
                    <div class="select-header" id="toHeader">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞–ª—é—Ç—É</div>
                    <div class="select-options" id="toOptions">
                        <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫...">
                        <div class="options-list" id="toOptionsList"></div>
                    </div>
                </div>
            </div>

            <div class="rate-info" id="rateInfo">–ö—É—Ä—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</div>
            <div class="result" id="result">‚Äî</div>
            <button id="nextBtn" disabled>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±–º–µ–Ω</button>
        </div>
    </div>

    <script>
        // –í–∞–ª—é—Ç—ã
        const currencies = [
            { value: "RUB", name: "–†–æ—Å—Å–∏–π—Å–∫–∏–π —Ä—É–±–ª—å (RUB)" },
            { value: "BTC", name: "Bitcoin (BTC)" },
            { value: "USDT", name: "Tether (USDT)" },
            { value: "ETH", name: "Ethereum (ETH)" },
            { value: "BNB", name: "Binance Coin (BNB)" },
            { value: "SOL", name: "Solana (SOL)" },
            { value: "XRP", name: "Ripple (XRP)" },
            { value: "ADA", name: "Cardano (ADA)" },
            { value: "DOGE", name: "Dogecoin (DOGE)" },
            { value: "TRX", name: "TRON (TRX)" },
            { value: "LTC", name: "Litecoin (LTC)" },
            { value: "MATIC", name: "Polygon (MATIC)" },
            { value: "DOT", name: "Polkadot (DOT)" },
            { value: "AVAX", name: "Avalanche (AVAX)" },
            { value: "SHIB", name: "Shiba Inu (SHIB)" },
            { value: "XMR", name: "Monero (XMR)" }
        ];

        // –ë–∞–Ω–∫–∏
        const banks = [
            { value: "sber", name: "–°–±–µ—Ä–ë–∞–Ω–∫" },
            { value: "tinkoff", name: "–¢–∏–Ω—å–∫–æ—Ñ—Ñ" },
            { value: "alfa", name: "–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫" },
            { value: "vtb", name: "–í–¢–ë" },
            { value: "gazprom", name: "–ì–∞–∑–ø—Ä–æ–º–±–∞–Ω–∫" },
            { value: "open", name: "–ë–∞–Ω–∫ –û—Ç–∫—Ä—ã—Ç–∏–µ" },
            { value: "raiffeisen", name: "–†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω –ë–∞–Ω–∫" },
            { value: "pochta", name: "–ü–æ—á—Ç–∞ –ë–∞–Ω–∫" },
            { value: "yoomoney", name: "–ÆMoney (–Ø–Ω–¥–µ–∫—Å)" },
            { value: "qiwi", name: "QIWI –ö–æ—à–µ–ª—ë–∫" },
            { value: "tochka", name: "–¢–æ—á–∫–∞ (–¥–ª—è –±–∏–∑–Ω–µ—Å–∞)" },
            { value: "mts", name: "–ú–¢–° –ë–∞–Ω–∫" }
        ];

        const cryptoCurrencies = currencies.filter(c => c.value !== "RUB");
        const allCurrencies = currencies;

        // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Å—É–º–º—ã (–≤ –µ–¥–∏–Ω–∏—Ü–∞—Ö –≤–∞–ª—é—Ç—ã)
        const minAmounts = {
            RUB: 100,
            BTC: 0.001,
            ETH: 0.01,
            USDT: 20,
            BNB: 0.05,
            SOL: 0.1,
            XRP: 20,
            ADA: 30,
            DOGE: 100,
            TRX: 100,
            LTC: 0.1,
            MATIC: 20,
            DOT: 5,
            AVAX: 1,
            SHIB: 100000,
            XMR: 0.05
        };

        const rates = {
            'RUB_BTC': 0.00000165, 'RUB_ETH': 0.000025, 'RUB_USDT': 0.011,
            'RUB_BNB': 0.000035, 'RUB_SOL': 0.00018, 'RUB_XRP': 0.017,
            'RUB_ADA': 0.038, 'RUB_DOGE': 0.15, 'RUB_LTC': 0.0016,
            'RUB_TRX': 0.12, 'RUB_MATIC': 0.019, 'RUB_DOT': 0.022,
            'RUB_AVAX': 0.011, 'RUB_SHIB': 1600, 'RUB_XMR': 0.0065,

            'BTC_RUB': 600000, 'ETH_RUB': 40000, 'USDT_RUB': 90,
            'BNB_RUB': 28000, 'SOL_RUB': 5500, 'XRP_RUB': 58,
            'ADA_RUB': 26, 'DOGE_RUB': 6.6, 'LTC_RUB': 620,
            'TRX_RUB': 8.3, 'MATIC_RUB': 52, 'DOT_RUB': 45,
            'AVAX_RUB': 90, 'SHIB_RUB': 0.000056, 'XMR_RUB': 154,

            'BTC_USDT': 65000, 'ETH_USDT': 3500, 'BNB_USDT': 600,
            'SOL_USDT': 150, 'XRP_USDT': 0.55, 'ADA_USDT': 0.45,
            'DOGE_USDT': 0.12, 'LTC_USDT': 80, 'TRX_USDT': 0.12,
            'MATIC_USDT': 0.85, 'DOT_USDT': 7.5, 'AVAX_USDT': 35,
            'SHIB_USDT': 0.00000002, 'XMR_USDT': 170,

            'USDT_BTC': 0.000015, 'USDT_ETH': 0.000285, 'USDT_BNB': 0.00166,
            'USDT_SOL': 0.0066, 'USDT_XRP': 1.8, 'USDT_ADA': 2.2,
            'USDT_DOGE': 8.3, 'USDT_LTC': 0.0125, 'USDT_TRX': 8.3,
            'USDT_MATIC': 1.17, 'USDT_DOT': 0.133, 'USDT_AVAX': 0.0285,
            'USDT_SHIB': 50000000, 'USDT_XMR': 0.00588
        };

        let fromValue = "RUB";
        let toValue = "BTC";
        let bankValue = "sber";

        // –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è dropdown
        function initDropdown(id, list, initial, onChange) {
            const header = document.getElementById(`${id}Header`);
            const optionsList = document.getElementById(`${id}OptionsList`);
            const container = document.getElementById(`${id}SelectCustom` || `${id}Select`);
            const searchInput = document.querySelector(`#${id}Options .search-input`);

            function renderOptions(items) {
                optionsList.innerHTML = items.map(item => 
                    `<div class="option ${item.value === initial ? 'selected' : ''}" data-value="${item.value}">
                        ${item.name}
                    </div>`
                ).join('');
            }

            renderOptions(list);
            header.textContent = list.find(c => c.value === initial)?.name || "–í—ã–±–µ—Ä–∏—Ç–µ";
            onChange(initial);

            const selectEl = document.getElementById(`${id}SelectCustom`) || document.getElementById(`${id}Select`);
            selectEl.addEventListener('click', (e) => {
                e.stopPropagation();
                document.querySelectorAll('.select-options').forEach(el => {
                    if (el.id !== `${id}Options`) el.classList.remove('active');
                });
                document.getElementById(`${id}Options`).classList.toggle('active');
            });

            optionsList.addEventListener('click', (e) => {
                if (e.target.classList.contains('option')) {
                    const value = e.target.dataset.value;
                    const name = e.target.textContent;
                    header.textContent = name;
                    document.querySelectorAll(`#${id}Options .option`).forEach(el => el.classList.remove('selected'));
                    e.target.classList.add('selected');
                    document.getElementById(`${id}Options`).classList.remove('active');
                    onChange(value);
                }
            });

            searchInput.addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                const filtered = list.filter(c => 
                    c.name.toLowerCase().includes(term) || c.value.toLowerCase().includes(term)
                );
                renderOptions(filtered);
            });

            document.getElementById(`${id}Options`).addEventListener('click', (e) => {
                e.stopPropagation();
            });
        }

        function getMinAmount(currency) {
            return minAmounts[currency] || 100;
        }

        function formatMinHint(currency) {
            const min = getMinAmount(currency);
            if (currency === 'SHIB') {
                return `–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: ${Math.floor(min).toLocaleString('ru-RU')} ${currency}`;
            }
            return `–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: ${min.toLocaleString('ru-RU', {
                minimumFractionDigits: currency === 'RUB' ? 2 : 6,
                maximumFractionDigits: currency === 'RUB' ? 2 : 8
            }).replace(/\.?0+$/, '')} ${currency}`;
        }

        function updateUI() {
            const amount = parseFloat(document.getElementById('amount').value) || 0;
            const bankSelectEl = document.getElementById('bankSelect');
            bankSelectEl.style.display = fromValue === 'RUB' ? 'block' : 'none';

            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
            document.getElementById('minHint').textContent = formatMinHint(fromValue);

            if (fromValue === toValue) {
                document.getElementById('rateInfo').textContent = '–ù–µ–ª—å–∑—è –æ–±–º–µ–Ω–∏–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –≤–∞–ª—é—Ç—ã';
                document.getElementById('result').textContent = '‚Äî';
                document.getElementById('nextBtn').disabled = true;
                return;
            }

            const rate = rates[`${fromValue}_${toValue}`] || 0;
            if (rate === 0) {
                document.getElementById('rateInfo').textContent = '–ö—É—Ä—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —ç—Ç–æ–π –ø–∞—Ä—ã';
                document.getElementById('result').textContent = '‚Äî';
                document.getElementById('nextBtn').disabled = true;
                return;
            }

            const result = amount * rate;
            const formattedResult = toValue === 'SHIB' 
                ? Math.floor(result).toLocaleString('ru-RU')
                : result.toLocaleString('ru-RU', {
                    minimumFractionDigits: toValue === 'RUB' ? 2 : 6,
                    maximumFractionDigits: toValue === 'RUB' ? 2 : 8
                }).replace(/\.?0+$/, '');

            document.getElementById('rateInfo').innerHTML = 
                `1 ${fromValue} ‚âà ${rate.toLocaleString('ru-RU', { maximumFractionDigits: 8 })} ${toValue}`;
            document.getElementById('result').innerHTML = 
                `${amount.toLocaleString('ru-RU')} ${fromValue} ‚âà <strong>${formattedResult} ${toValue}</strong>`;

            const minAmount = getMinAmount(fromValue);
            document.getElementById('nextBtn').disabled = amount < minAmount;
        }

        document.getElementById('nextBtn').addEventListener('click', () => {
            const amount = document.getElementById('amount').value;
            const params = new URLSearchParams({ from: fromValue, to: toValue, amount });
            if (fromValue === 'RUB') params.append('bank', bankValue);
            window.location.href = `exchange.html?${params.toString()}`;
        });

        document.getElementById('amount').addEventListener('input', updateUI);

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        initDropdown('from', allCurrencies, 'RUB', (val) => {
            fromValue = val;
            updateUI();
        });

        initDropdown('to', [...cryptoCurrencies, { value: "RUB", name: "–†–æ—Å—Å–∏–π—Å–∫–∏–π —Ä—É–±–ª—å (RUB)" }], 'BTC', (val) => {
            toValue = val;
            updateUI();
        });

        initDropdown('bank', banks, 'sber', (val) => {
            bankValue = val;
        });

        document.addEventListener('click', (e) => {
            if (!e.target.closest('.custom-select')) {
                document.querySelectorAll('.select-options').forEach(el => el.classList.remove('active'));
            }
        });

        updateUI();
    </script>
</body>
</html>
